<dx:ThemedWindow x:Class="Revit_FA_Tools.ProgressWindow"
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                Title="Analysis Progress"
                Width="500"
                Height="250"
                ResizeMode="NoResize"
                WindowStartupLocation="CenterOwner"
                WindowStyle="ToolWindow"
                ShowInTaskbar="False"
                Topmost="True">
    
    <Window.Resources>
        <!-- DevExpress Progress Window Theme Resources -->
        <SolidColorBrush x:Key="ProgressDarkBackgroundBrush" Color="#FF1E1E1E"/>
        <SolidColorBrush x:Key="ProgressDarkCardBackgroundBrush" Color="#FF2D2D30"/>
        <SolidColorBrush x:Key="ProgressDarkBorderBrush" Color="#FF3F3F46"/>
        <SolidColorBrush x:Key="ProgressDarkTextBrush" Color="#FFFFFFFF"/>
        <SolidColorBrush x:Key="ProgressDarkSecondaryTextBrush" Color="#FFB0B0B0"/>
        <SolidColorBrush x:Key="ProgressAccentBrush" Color="#FF0078D4"/>
        
        <Style x:Key="ProgressTitleStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource ProgressDarkTextBrush}"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
        
        <Style x:Key="ProgressBodyStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource ProgressDarkTextBrush}"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>
        
        <Style x:Key="ProgressDetailStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource ProgressDarkSecondaryTextBrush}"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>

        <!-- DevExpress Progress Bar Style -->
        <Style x:Key="DevExpressProgressStyle" TargetType="dxe:ProgressBarEdit">
            <Setter Property="Background" Value="{StaticResource ProgressDarkCardBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource ProgressDarkBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="ShowBorder" Value="True"/>
            <Setter Property="ContentDisplayMode" Value="Value"/>
            <Setter Property="DisplayFormatString" Value="{}{0}%"/>
        </Style>

        <!-- DevExpress Button Style -->
        <Style x:Key="DevExpressButtonStyle" TargetType="dx:SimpleButton">
            <Setter Property="Background" Value="{StaticResource ProgressDarkCardBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource ProgressDarkTextBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource ProgressAccentBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="15"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with Icon and Title -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Center">
            <dx:DXImage Source="{dx:DXImage SvgImages/Icon Builder/Actions_Execute.svg}" 
                        Width="24" Height="24" Margin="0,0,10,0" VerticalAlignment="Center"/>
            <TextBlock Text="System Analysis Progress"
                       FontSize="16"
                       FontWeight="Bold"
                       VerticalAlignment="Center"
                       Style="{StaticResource ProgressTitleStyle}"/>
        </StackPanel>

        <!-- Current Operation -->
        <StackPanel Grid.Row="2" Orientation="Horizontal">
            <dx:DXImage x:Name="OperationIcon" 
                        Source="{dx:DXImage SvgImages/Icon Builder/Actions_Process.svg}" 
                        Width="16" Height="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
            <TextBlock x:Name="OperationLabel"
                       Text="Initializing analysis..."
                       FontSize="13"
                       FontWeight="Medium"
                       VerticalAlignment="Center"
                       Style="{StaticResource ProgressBodyStyle}"/>
        </StackPanel>

        <!-- DevExpress Progress Bar -->
        <dxe:ProgressBarEdit Grid.Row="4"
                             x:Name="MainProgressBar"
                             Height="24"
                             Minimum="0"
                             Maximum="100"
                             EditValue="0"
                             Style="{StaticResource DevExpressProgressStyle}"/>

        <!-- Progress Text with Icon -->
        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Center">
            <dx:DXImage Source="{dx:DXImage SvgImages/Icon Builder/Actions_Time.svg}" 
                        Width="12" Height="12" Margin="0,0,5,0" VerticalAlignment="Center"/>
            <TextBlock x:Name="ProgressText"
                       Text="0% Complete"
                       FontSize="11"
                       VerticalAlignment="Center"
                       Style="{StaticResource ProgressBodyStyle}"/>
        </StackPanel>

        <!-- Details and Real-time Info -->
        <ScrollViewer Grid.Row="7" VerticalScrollBarVisibility="Auto" MaxHeight="60" Margin="0,10,0,0">
            <StackPanel>
                <!-- General Details -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                    <dx:DXImage Source="{dx:DXImage SvgImages/Icon Builder/Actions_Info.svg}" 
                                Width="12" Height="12" Margin="0,0,8,0" VerticalAlignment="Top"/>
                    <TextBlock x:Name="DetailsLabel"
                               Text="Preparing analysis environment..."
                               FontSize="10"
                               TextWrapping="Wrap"
                               VerticalAlignment="Top"
                               Style="{StaticResource ProgressDetailStyle}"/>
                </StackPanel>
                
                <!-- Current File/Instance Info -->
                <StackPanel x:Name="CurrentItemPanel" Orientation="Horizontal" Margin="0,2,0,2" Visibility="Collapsed">
                    <dx:DXImage Source="{dx:DXImage SvgImages/Icon Builder/Actions_Properties.svg}" 
                                Width="10" Height="10" Margin="0,0,6,0" VerticalAlignment="Top"/>
                    <TextBlock x:Name="CurrentItemLabel"
                               Text=""
                               FontSize="9"
                               TextWrapping="Wrap"
                               VerticalAlignment="Top"
                               Foreground="#FF90EE90"
                               FontFamily="Consolas"/>
                </StackPanel>
                
                <!-- Current Operation Info -->
                <StackPanel x:Name="CurrentOperationPanel" Orientation="Horizontal" Margin="0,2,0,0" Visibility="Collapsed">
                    <dx:DXImage Source="{dx:DXImage SvgImages/Icon Builder/Actions_Process.svg}" 
                                Width="10" Height="10" Margin="0,0,6,0" VerticalAlignment="Top"/>
                    <TextBlock x:Name="CurrentOperationLabel"
                               Text=""
                               FontSize="9"
                               TextWrapping="Wrap"
                               VerticalAlignment="Top"
                               Foreground="#FFADD8E6"
                               FontFamily="Consolas"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- DevExpress Cancel Button -->
        <dx:SimpleButton Grid.Row="8"
                         x:Name="CancelButton"
                         Width="90"
                         Height="32"
                         HorizontalAlignment="Center"
                         Margin="0,15,0,0"
                         Click="CancelButton_Click"
                         Style="{StaticResource DevExpressButtonStyle}">
            <dx:SimpleButton.Content>
                <StackPanel Orientation="Horizontal">
                    <dx:DXImage Source="{dx:DXImage SvgImages/Icon Builder/Actions_Cancel.svg}" Width="16" Height="16" Margin="0,0,5,0"/>
                    <TextBlock Text="Cancel" VerticalAlignment="Center"/>
                </StackPanel>
            </dx:SimpleButton.Content>
        </dx:SimpleButton>
    </Grid>
</dx:ThemedWindow>