<dx:ThemedWindow x:Class="Revit_FA_Tools.Views.MappingEditor"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             Title="Candela Current Mapping Editor" 
             Height="700" Width="1000"
             WindowStartupLocation="CenterOwner"
             ShowInTaskbar="False">

    <dx:ThemedWindow.Resources>
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
    </dx:ThemedWindow.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <dxb:ToolBarControl Grid.Row="0" AllowCustomizationMenu="False">
            <dxb:BarButtonItem Name="btnAddDevice" 
                              Content="Add Device Type" 
                              Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_Add.svg}"
                              ItemClick="btnAddDevice_Click"/>
            <dxb:BarButtonItem Name="btnDeleteDevice" 
                              Content="Delete Selected" 
                              Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_Delete.svg}"
                              ItemClick="btnDeleteDevice_Click"/>
            <dxb:BarItemSeparator/>
            <dxb:BarButtonItem Name="btnImportMapping" 
                              Content="Import CSV" 
                              Glyph="{dx:DXImage SvgImages/Spreadsheet/ImportCSV.svg}"
                              ItemClick="btnImportMapping_Click"/>
            <dxb:BarButtonItem Name="btnExportMapping" 
                              Content="Export CSV" 
                              Glyph="{dx:DXImage SvgImages/Spreadsheet/ExportToCSV.svg}"
                              ItemClick="btnExportMapping_Click"/>
            <dxb:BarItemSeparator/>
            <dxb:BarButtonItem Name="btnReload" 
                              Content="Reload" 
                              Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_Refresh.svg}"
                              ItemClick="btnReload_Click"/>
            <dxb:BarButtonItem Name="btnSave" 
                              Content="Save Changes" 
                              Glyph="{dx:DXImage SvgImages/Save/Save.svg}"
                              ItemClick="btnSave_Click"/>
        </dxb:ToolBarControl>

        <!-- Main Grid -->
        <dxg:GridControl Grid.Row="1" Name="mappingGrid" 
                        AutoGenerateColumns="None"
                        EnableSmartColumnsGeneration="False"
                        SelectionMode="Row">
            <dxg:GridControl.View>
                <dxg:TableView Name="mappingView" 
                              ShowGroupPanel="False"
                              AllowEditing="True"
                              NavigationStyle="Cell"
                              AllowPerPixelScrolling="True"
                              ShowAutoFilterRow="True"
                              ShowSearchPanelMode="Always">
                    <dxg:TableView.RowCellMenuCustomizations>
                        <dxb:BarButtonItem Content="Duplicate Row" 
                                          ItemClick="DuplicateRow_Click"
                                          Glyph="{dx:DXImage SvgImages/Edit/Copy.svg}"/>
                        <dxb:BarItemSeparator/>
                        <dxb:BarButtonItem Content="Delete Row" 
                                          ItemClick="DeleteRow_Click"
                                          Glyph="{dx:DXImage SvgImages/Icon Builder/Actions_Delete.svg}"/>
                    </dxg:TableView.RowCellMenuCustomizations>
                </dxg:TableView>
            </dxg:GridControl.View>

            <dxg:GridControl.Columns>
                <!-- Device Identification -->
                <dxg:GridColumn FieldName="DeviceKey" Header="Device Key" Width="200" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                
                <dxg:GridColumn FieldName="Description" Header="Description" Width="250" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>

                <!-- Device Classification -->
                <dxg:GridColumn FieldName="IsSpeaker" Header="Is Speaker" Width="80" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:CheckEditSettings/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                
                <dxg:GridColumn FieldName="HasStrobe" Header="Has Strobe" Width="80" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:CheckEditSettings/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                
                <dxg:GridColumn FieldName="IsAudioDevice" Header="Is Audio" Width="80" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:CheckEditSettings/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>

                <!-- Electrical Values -->
                <dxg:GridColumn FieldName="DefaultCurrent" Header="Current (A)" Width="100" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:SpinEditSettings MinValue="0" MaxValue="5" Increment="0.001" 
                                            DisplayFormat="F3" Mask="n3"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                
                <dxg:GridColumn FieldName="DefaultUnitLoads" Header="Unit Loads" Width="100" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:SpinEditSettings MinValue="1" MaxValue="10" Increment="1"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>

                <!-- Additional Settings -->
                <dxg:GridColumn FieldName="DeviceFunction" Header="Function" Width="120" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:ComboBoxEditSettings IsTextEditable="True">
                            <dxe:ComboBoxEditSettings.Items>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">NOTIFICATION</sys:String>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">DETECTION</sys:String>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">MODULE</sys:String>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">PROTECTION</sys:String>
                            </dxe:ComboBoxEditSettings.Items>
                        </dxe:ComboBoxEditSettings>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>

                <dxg:GridColumn FieldName="MountingType" Header="Mounting" Width="100" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:ComboBoxEditSettings IsTextEditable="True">
                            <dxe:ComboBoxEditSettings.Items>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">WALL</sys:String>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">CEILING</sys:String>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">OUTDOOR</sys:String>
                            </dxe:ComboBoxEditSettings.Items>
                        </dxe:ComboBoxEditSettings>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
            </dxg:GridControl.Columns>
        </dxg:GridControl>

        <!-- Status Bar -->
        <Grid Grid.Row="2" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <TextBlock Grid.Column="0" Name="statusText" 
                      Text="Ready" 
                      Margin="10,5" 
                      VerticalAlignment="Center"/>
            
            <TextBlock Grid.Column="1" Name="deviceCountText" 
                      Text="0 devices" 
                      Margin="10,5" 
                      VerticalAlignment="Center"/>
            
            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="10,5">
                <Button Name="btnCancel" Content="Cancel" Width="80" Margin="5,0" Click="btnCancel_Click"/>
                <Button Name="btnApply" Content="Apply" Width="80" Margin="5,0" Click="btnApply_Click" 
                       FontWeight="Bold" IsDefault="True"/>
            </StackPanel>
        </Grid>
    </Grid>
</dx:ThemedWindow>