<dx:ThemedWindow x:Class="Revit_FA_Tools.Views.AddressingPanelWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
        xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
        dx:ThemeManager.ThemeName="Win11Dark"
        Title="Device Addressing Management"
        Height="700" 
        Width="1200" 
        >



    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <ToolBar Grid.Row="0" Height="35">
            <Button Name="AutoAssignBtn" Content="Auto Assign (Branch)" Padding="10,3" Margin="5,2" 
                    ToolTip="Sequential assignment respecting locks and manual values" Click="AutoAssign_Click"/>
            <Button Name="ResequenceBtn" Content="Re-sequence (Branch)" Padding="10,3" Margin="5,2" 
                    ToolTip="Compact addresses for Auto devices only" Click="Resequence_Click"/>
            <Button Name="GapFillBtn" Content="Gap Fill (Branch)" Padding="10,3" Margin="5,2" 
                    ToolTip="Fill gaps left by removals" Click="GapFill_Click"/>
            <Button Name="FirstAvailableBtn" Content="First Available (Device)" Padding="10,3" Margin="5,2" 
                    ToolTip="Assign first free slot for selected device" Click="FirstAvailable_Click"/>
            <Separator/>
            <Button Name="ValidateBtn" Content="Validate" Padding="10,3" Margin="5,2" 
                    ToolTip="Check for address conflicts" Click="Validate_Click"/>
            <Button Name="ResolveConflictsBtn" Content="Resolve Conflicts" Padding="10,3" Margin="5,2" 
                    ToolTip="Auto-resolve conflicts by gap-filling Auto devices" Click="ResolveConflicts_Click"/>
            <Separator/>
            <Button Name="SaveToRevitBtn" Content="Save to Revit" Padding="10,3" Margin="5,2" 
                    Background="Orange" FontWeight="Bold"
                    ToolTip="Push addresses back to Revit parameters" Click="SaveToRevit_Click"/>
        </ToolBar>

        <!-- Options Panel -->
        <GroupBox Grid.Row="1" Header="Addressing Options" Margin="10,5" Height="80" VerticalAlignment="Top">
            <StackPanel Orientation="Horizontal" Margin="10">
                <Label Content="Start Address:" VerticalAlignment="Center"/>
                <dxe:SpinEdit Name="StartAddressSpinner" Value="1" MinValue="1" MaxValue="999" Width="60" Margin="5,0"/>
                <CheckBox Name="PreserveManualChk" Content="Preserve Manual" IsChecked="True" Margin="15,0,0,0" 
                          ToolTip="Do not overwrite user-entered values"/>
                <CheckBox Name="RespectLocksChk" Content="Respect Locks" IsChecked="True" Margin="15,0,0,0" 
                          ToolTip="Do not move devices marked Locked"/>
                <CheckBox Name="GapFillChk" Content="Gap Fill" IsChecked="True" Margin="15,0,0,0" 
                          ToolTip="Fill gaps left by removals"/>
                <Label Content="Branch:" Margin="30,0,5,0" VerticalAlignment="Center"/>
                <ComboBox Name="BranchSelector" Width="150" Margin="5,0" SelectionChanged="BranchSelector_SelectionChanged"/>
            </StackPanel>
        </GroupBox>

        <!-- Device Grid -->
        <dxg:GridControl Name="DeviceGrid" Grid.Row="1" Margin="10,90,10,10" SelectionMode="Row">
            <dxg:GridControl.View>
                <dxg:TableView ShowGroupPanel="False" 
                              AllowEditing="True"
                              NavigationStyle="Row"
                              ShowIndicator="True"
                              AutoWidth="True"
                              AllowColumnFiltering="True"
                              AllowSorting="True" AllowDragDrop="True"/>
            </dxg:GridControl.View>

            <dxg:GridControl.Columns>
                <dxg:GridColumn FieldName="ElementId" Header="Element ID" Width="80" AllowEditing="False"/>
                <dxg:GridColumn FieldName="Level" Header="Level" Width="100" AllowEditing="False"/>
                <dxg:GridColumn FieldName="Family" Header="Family" Width="120" AllowEditing="False"/>
                <dxg:GridColumn FieldName="Type" Header="Type" Width="120" AllowEditing="False"/>
                <dxg:GridColumn FieldName="BranchId" Header="Branch" Width="100" AllowEditing="False"/>
                <dxg:GridColumn FieldName="Address" Header="Address" Width="80" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:SpinEditSettings MinValue="0" MaxValue="999"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                <dxg:GridColumn FieldName="AddressSlots" Header="Slots" Width="60" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:SpinEditSettings MinValue="1" MaxValue="4"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                <dxg:GridColumn FieldName="LockState" Header="Lock State" Width="80" AllowEditing="True">
                    <dxg:GridColumn.EditSettings>
                        <dxe:ComboBoxEditSettings>
                            <dxe:ComboBoxEditSettings.Items>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">Auto</sys:String>
                                <sys:String xmlns:sys="clr-namespace:System;assembly=mscorlib">Locked</sys:String>
                            </dxe:ComboBoxEditSettings.Items>
                        </dxe:ComboBoxEditSettings>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                <dxg:GridColumn FieldName="StatusDescription" Header="Status" Width="150" AllowEditing="False"/>
                <dxg:GridColumn FieldName="ValidationMessage" Header="Issues" Width="200" AllowEditing="False"/>
            </dxg:GridControl.Columns>
        </dxg:GridControl>

        <!-- Status Panel -->
        <GroupBox Grid.Row="2" Header="Address Summary" Margin="10,5" Height="80">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Margin="10">
                    <Label Content="Address Range:" FontWeight="Bold"/>
                    <TextBlock Name="AddressRangeText" Text="1-50" FontSize="14"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Margin="10">
                    <Label Content="Total Devices:" FontWeight="Bold"/>
                    <TextBlock Name="TotalDevicesText" Text="25" FontSize="14"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Margin="10">
                    <Label Content="Locked Devices:" FontWeight="Bold"/>
                    <TextBlock Name="LockedDevicesText" Text="5" FontSize="14"/>
                </StackPanel>

                <StackPanel Grid.Column="3" Margin="10">
                    <Label Content="Conflicts:" FontWeight="Bold"/>
                    <TextBlock Name="ConflictsText" Text="0" FontSize="14" Foreground="Green"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Close Button -->
        <Button Grid.Row="3" Content="Close" Width="80" Height="30" 
                HorizontalAlignment="Right" Margin="10" 
                Click="Close_Click"/>
    </Grid>
</dx:ThemedWindow>